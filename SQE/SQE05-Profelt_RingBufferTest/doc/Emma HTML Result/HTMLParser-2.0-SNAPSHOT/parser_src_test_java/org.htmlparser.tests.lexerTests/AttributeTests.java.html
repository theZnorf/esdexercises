<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../.resources/report.gif" type="image/gif"/><title>AttributeTests.java</title><link rel="stylesheet" href="../../../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../.sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">AllTests (4) (Oct 27, 2015 3:17:09 PM)</a> &gt; <a href="../../index.html" class="el_group">HTMLParser-2.0-SNAPSHOT</a> &gt; <a href="../index.html" class="el_bundle">parser/src/test/java</a> &gt; <a href="index.source.html" class="el_package">org.htmlparser.tests.lexerTests</a> &gt; <span class="el_source">AttributeTests.java</span></div><h1>AttributeTests.java</h1><pre class="source lang-java linenums">// HTMLParser Library - A java-based parser for HTML
// http://htmlparser.org
// Copyright (C) 2006 Derrick Oswald
//
// Revision Control Information
//
// $URL: https://svn.sourceforge.net/svnroot/htmlparser/trunk/parser/src/test/java/org/htmlparser/tests/lexerTests/AttributeTests.java $
// $Author: derrickoswald $
// $Date: 2006-09-16 10:44:17 -0400 (Sat, 16 Sep 2006) $
// $Revision: 4 $
//
// This library is free software; you can redistribute it and/or
// modify it under the terms of the Common Public License; either
// version 1.0 of the License, or (at your option) any later version.
//
// This library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
// Common Public License for more details.
//
// You should have received a copy of the Common Public License
// along with this library; if not, the license is available from
// the Open Source Initiative (OSI) website:
//   http://opensource.org/licenses/cpl1.0.php

package org.htmlparser.tests.lexerTests;

import java.util.Vector;
import org.htmlparser.Node;

import org.htmlparser.Attribute;
import org.htmlparser.PrototypicalNodeFactory;
import org.htmlparser.Tag;
import org.htmlparser.lexer.PageAttribute;
import org.htmlparser.nodes.TagNode;
import org.htmlparser.tags.ImageTag;
import org.htmlparser.tags.LinkTag;
import org.htmlparser.tests.ParserTestCase;
import org.htmlparser.util.NodeIterator;
import org.htmlparser.util.ParserException;

public class AttributeTests extends ParserTestCase
{
    static
    {
<span class="fc" id="L46">        System.setProperty (&quot;org.htmlparser.tests.lexerTests.AttributeTests&quot;, &quot;AttributeTests&quot;);</span>
    }

<span class="fc" id="L49">    private static final boolean JSP_TESTS_ENABLED = false;</span>
    private Tag tag;
    private Vector attributes;

    public AttributeTests (String name) {
<span class="fc" id="L54">        super(name);</span>
<span class="fc" id="L55">    }</span>

    public void getParameterTableFor(String tagContents)
    {
<span class="fc" id="L59">        getParameterTableFor (tagContents, false);</span>
<span class="fc" id="L60">    }</span>

    public void getParameterTableFor(String tagContents, boolean dump)
    {
        String html;
        NodeIterator iterator;
        Node node;

<span class="fc" id="L68">        html = &quot;&lt;&quot; + tagContents + &quot;&gt;&quot;;</span>
<span class="fc" id="L69">        createParser (html);</span>
<span class="fc" id="L70">        parser.setNodeFactory (new PrototypicalNodeFactory (true));</span>
        try
        {
<span class="fc" id="L73">            iterator = parser.elements ();</span>
<span class="fc" id="L74">            node = iterator.nextNode ();</span>
<span class="fc bfc" id="L75" title="All 2 branches covered.">            if (node instanceof Tag)</span>
            {
<span class="fc" id="L77">                tag = (Tag)node;</span>
<span class="fc" id="L78">                attributes = tag.getAttributesEx ();</span>
<span class="pc bpc" id="L79" title="1 of 2 branches missed.">                if (dump)</span>
                {
<span class="nc bnc" id="L81" title="All 2 branches missed.">                    for (int i = 0; i &lt; attributes.size (); i++)</span>
                    {
<span class="nc" id="L83">                        System.out.print (&quot;Attribute #&quot; + i);</span>
<span class="nc" id="L84">                        Attribute attribute = (Attribute)attributes.elementAt (i);</span>
<span class="nc bnc" id="L85" title="All 2 branches missed.">                        if (null != attribute.getName ())</span>
<span class="nc" id="L86">                            System.out.print (&quot; Name: '&quot; + attribute.getName () + &quot;'&quot;);</span>
<span class="nc bnc" id="L87" title="All 2 branches missed.">                        if (null != attribute.getAssignment ())</span>
<span class="nc" id="L88">                            System.out.print (&quot; Assignment: '&quot; + attribute.getAssignment () + &quot;'&quot;);</span>
<span class="nc bnc" id="L89" title="All 2 branches missed.">                        if (0 != attribute.getQuote ())</span>
<span class="nc" id="L90">                            System.out.print (&quot; Quote: &quot; + attribute.getQuote ());</span>
<span class="nc bnc" id="L91" title="All 2 branches missed.">                        if (null != attribute.getValue ())</span>
<span class="nc" id="L92">                            System.out.print (&quot; Value: '&quot; + attribute.getValue () + &quot;'&quot;);</span>
<span class="nc" id="L93">                        System.out.println ();</span>
                    }
<span class="nc" id="L95">                    System.out.println ();</span>
                }
<span class="nc" id="L97">            }</span>
            else
<span class="fc" id="L99">                attributes = null;</span>
<span class="fc" id="L100">            String string = node.toHtml ();</span>
<span class="fc" id="L101">            assertEquals (&quot;toHtml differs&quot;, html, string);</span>
<span class="pc bpc" id="L102" title="1 of 2 branches missed.">            assertTrue (&quot;shouldn't be any more nodes&quot;, !iterator.hasMoreNodes ());</span>
<span class="fc" id="L103">        }</span>
<span class="nc" id="L104">        catch (ParserException pe)</span>
        {
<span class="nc" id="L106">            fail (pe.getMessage ());</span>
        }
<span class="fc" id="L108">    }</span>

    /**
     * Test constructors.
     */
    public void testConstructors ()
    {
        Vector attributes;
        Tag tag;
        String html;

<span class="fc" id="L119">        attributes = new Vector ();</span>
         // String, null
<span class="fc" id="L121">        attributes.add (new Attribute (&quot;wombat&quot;, null));</span>
        // String
<span class="fc" id="L123">        attributes.add (new Attribute (&quot; &quot;));</span>
        // String, String
<span class="fc" id="L125">        attributes.add (new Attribute (&quot;label&quot;, &quot;The civil war.&quot;));</span>
<span class="fc" id="L126">        attributes.add (new Attribute (&quot; &quot;));</span>
        // String, String, String
<span class="fc" id="L128">        attributes.add (new Attribute (&quot;frameborder&quot;, &quot;= &quot;, &quot;no&quot;));</span>
<span class="fc" id="L129">        attributes.add (new Attribute (&quot; &quot;));</span>
        // String String, String, char
<span class="fc" id="L131">        attributes.add (new Attribute (&quot;name&quot;, &quot;=&quot;, &quot;topFrame&quot;, '&quot;'));</span>
<span class="fc" id="L132">        tag = new TagNode (null, 0, 0, attributes);</span>
<span class="fc" id="L133">        html = &quot;&lt;wombat label=\&quot;The civil war.\&quot; frameborder= no name=\&quot;topFrame\&quot;&gt;&quot;;</span>
<span class="fc" id="L134">        assertStringEquals (&quot;tag contents&quot;, html, tag.toHtml ());</span>
<span class="fc" id="L135">    }</span>

    /**
     * Test bean properties.
     */
    public void testProperties ()
    {
        Attribute attribute;
        Attribute space;
        Vector attributes;
        Tag tag;
        String html;

<span class="fc" id="L148">        attributes = new Vector ();</span>
<span class="fc" id="L149">        attribute = new Attribute ();</span>
<span class="fc" id="L150">        attribute.setName (&quot;wombat&quot;);</span>
<span class="fc" id="L151">        assertTrue (&quot;should be standalone&quot;, attribute.isStandAlone ());</span>
<span class="pc bpc" id="L152" title="1 of 2 branches missed.">        assertTrue (&quot;should not be whitespace&quot;, !attribute.isWhitespace ());</span>
<span class="pc bpc" id="L153" title="1 of 2 branches missed.">        assertTrue (&quot;should not be valued&quot;, !attribute.isValued ());</span>
<span class="pc bpc" id="L154" title="1 of 2 branches missed.">        assertTrue (&quot;should not be empty&quot;, !attribute.isEmpty ());</span>
<span class="fc" id="L155">        attributes.add (attribute);</span>
<span class="fc" id="L156">        space = new Attribute ();</span>
<span class="fc" id="L157">        space.setValue (&quot; &quot;);</span>
<span class="pc bpc" id="L158" title="1 of 2 branches missed.">        assertTrue (&quot;should not be standalone&quot;, !space.isStandAlone ());</span>
<span class="fc" id="L159">        assertTrue (&quot;should be whitespace&quot;, space.isWhitespace ());</span>
<span class="fc" id="L160">        assertTrue (&quot;should be valued&quot;, space.isValued ());</span>
<span class="pc bpc" id="L161" title="1 of 2 branches missed.">        assertTrue (&quot;should not be empty&quot;, !space.isEmpty ());</span>
<span class="fc" id="L162">        attributes.add (space);</span>
<span class="fc" id="L163">        attribute = new Attribute ();</span>
<span class="fc" id="L164">        attribute.setName (&quot;label&quot;);</span>
<span class="fc" id="L165">        attribute.setAssignment (&quot;=&quot;);</span>
<span class="fc" id="L166">        attribute.setRawValue (&quot;The civil war.&quot;);</span>
<span class="pc bpc" id="L167" title="1 of 2 branches missed.">        assertTrue (&quot;should not be standalone&quot;, !attribute.isStandAlone ());</span>
<span class="pc bpc" id="L168" title="1 of 2 branches missed.">        assertTrue (&quot;should not be whitespace&quot;, !attribute.isWhitespace ());</span>
<span class="fc" id="L169">        assertTrue (&quot;should be valued&quot;, attribute.isValued ());</span>
<span class="pc bpc" id="L170" title="1 of 2 branches missed.">        assertTrue (&quot;should not be empty&quot;, !attribute.isEmpty ());</span>
<span class="fc" id="L171">        attributes.add (attribute);</span>
<span class="fc" id="L172">        attributes.add (space);</span>
<span class="fc" id="L173">        attribute = new Attribute ();</span>
<span class="fc" id="L174">        attribute.setName (&quot;frameborder&quot;);</span>
<span class="fc" id="L175">        attribute.setAssignment (&quot;= &quot;);</span>
<span class="fc" id="L176">        attribute.setRawValue (&quot;no&quot;);</span>
<span class="fc" id="L177">        attributes.add (attribute);</span>
<span class="fc" id="L178">        attributes.add (space);</span>
<span class="fc" id="L179">        attribute = new Attribute ();</span>
<span class="fc" id="L180">        attribute.setName (&quot;name&quot;);</span>
<span class="fc" id="L181">        attribute.setAssignment (&quot;=&quot;);</span>
<span class="fc" id="L182">        attribute.setValue (&quot;topFrame&quot;);</span>
<span class="fc" id="L183">        attribute.setQuote ('&quot;');</span>
<span class="pc bpc" id="L184" title="1 of 2 branches missed.">        assertTrue (&quot;should not be standalone&quot;, !attribute.isStandAlone ());</span>
<span class="pc bpc" id="L185" title="1 of 2 branches missed.">        assertTrue (&quot;should not be whitespace&quot;, !attribute.isWhitespace ());</span>
<span class="fc" id="L186">        assertTrue (&quot;should be valued&quot;, attribute.isValued ());</span>
<span class="pc bpc" id="L187" title="1 of 2 branches missed.">        assertTrue (&quot;should not be empty&quot;, !attribute.isEmpty ());</span>
<span class="fc" id="L188">        attributes.add (attribute);</span>
<span class="fc" id="L189">        tag = new TagNode (null, 0, 0, attributes);</span>
<span class="fc" id="L190">        html = &quot;&lt;wombat label=\&quot;The civil war.\&quot; frameborder= no name=\&quot;topFrame\&quot;&gt;&quot;;</span>
<span class="fc" id="L191">        assertStringEquals (&quot;tag contents&quot;, html, tag.toHtml ());</span>
<span class="fc" id="L192">    }</span>

    /**
     * Test constructors.
     */
    public void testConstructors2 ()
    {
        Vector attributes;
        Tag tag;
        String html;

<span class="fc" id="L203">        attributes = new Vector ();</span>
         // String, null
<span class="fc" id="L205">        attributes.add (new PageAttribute (&quot;wombat&quot;, null));</span>
        // String
<span class="fc" id="L207">        attributes.add (new PageAttribute (&quot; &quot;));</span>
        // String, String
<span class="fc" id="L209">        attributes.add (new PageAttribute (&quot;label&quot;, &quot;The civil war.&quot;));</span>
<span class="fc" id="L210">        attributes.add (new PageAttribute (&quot; &quot;));</span>
        // String, String, String
<span class="fc" id="L212">        attributes.add (new PageAttribute (&quot;frameborder&quot;, &quot;= &quot;, &quot;no&quot;));</span>
<span class="fc" id="L213">        attributes.add (new PageAttribute (&quot; &quot;));</span>
        // String String, String, char
<span class="fc" id="L215">        attributes.add (new PageAttribute (&quot;name&quot;, &quot;=&quot;, &quot;topFrame&quot;, '&quot;'));</span>
<span class="fc" id="L216">        tag = new TagNode (null, 0, 0, attributes);</span>
<span class="fc" id="L217">        html = &quot;&lt;wombat label=\&quot;The civil war.\&quot; frameborder= no name=\&quot;topFrame\&quot;&gt;&quot;;</span>
<span class="fc" id="L218">        assertStringEquals (&quot;tag contents&quot;, html, tag.toHtml ());</span>
<span class="fc" id="L219">    }</span>

    /**
     * Test bean properties.
     */
    public void testProperties2 ()
    {
        Attribute attribute;
        Attribute space;
        Vector attributes;
        Tag tag;
        String html;

<span class="fc" id="L232">        attributes = new Vector ();</span>
<span class="fc" id="L233">        attribute = new PageAttribute ();</span>
<span class="fc" id="L234">        attribute.setName (&quot;wombat&quot;);</span>
<span class="fc" id="L235">        assertTrue (&quot;should be standalone&quot;, attribute.isStandAlone ());</span>
<span class="pc bpc" id="L236" title="1 of 2 branches missed.">        assertTrue (&quot;should not be whitespace&quot;, !attribute.isWhitespace ());</span>
<span class="pc bpc" id="L237" title="1 of 2 branches missed.">        assertTrue (&quot;should not be valued&quot;, !attribute.isValued ());</span>
<span class="pc bpc" id="L238" title="1 of 2 branches missed.">        assertTrue (&quot;should not be empty&quot;, !attribute.isEmpty ());</span>
<span class="fc" id="L239">        attributes.add (attribute);</span>
<span class="fc" id="L240">        space = new PageAttribute ();</span>
<span class="fc" id="L241">        space.setValue (&quot; &quot;);</span>
<span class="pc bpc" id="L242" title="1 of 2 branches missed.">        assertTrue (&quot;should not be standalone&quot;, !space.isStandAlone ());</span>
<span class="fc" id="L243">        assertTrue (&quot;should be whitespace&quot;, space.isWhitespace ());</span>
<span class="fc" id="L244">        assertTrue (&quot;should be valued&quot;, space.isValued ());</span>
<span class="pc bpc" id="L245" title="1 of 2 branches missed.">        assertTrue (&quot;should not be empty&quot;, !space.isEmpty ());</span>
<span class="fc" id="L246">        attributes.add (space);</span>
<span class="fc" id="L247">        attribute = new PageAttribute ();</span>
<span class="fc" id="L248">        attribute.setName (&quot;label&quot;);</span>
<span class="fc" id="L249">        attribute.setAssignment (&quot;=&quot;);</span>
<span class="fc" id="L250">        attribute.setRawValue (&quot;The civil war.&quot;);</span>
<span class="pc bpc" id="L251" title="1 of 2 branches missed.">        assertTrue (&quot;should not be standalone&quot;, !attribute.isStandAlone ());</span>
<span class="pc bpc" id="L252" title="1 of 2 branches missed.">        assertTrue (&quot;should not be whitespace&quot;, !attribute.isWhitespace ());</span>
<span class="fc" id="L253">        assertTrue (&quot;should be valued&quot;, attribute.isValued ());</span>
<span class="pc bpc" id="L254" title="1 of 2 branches missed.">        assertTrue (&quot;should not be empty&quot;, !attribute.isEmpty ());</span>
<span class="fc" id="L255">        attributes.add (attribute);</span>
<span class="fc" id="L256">        attributes.add (space);</span>
<span class="fc" id="L257">        attribute = new PageAttribute ();</span>
<span class="fc" id="L258">        attribute.setName (&quot;frameborder&quot;);</span>
<span class="fc" id="L259">        attribute.setAssignment (&quot;= &quot;);</span>
<span class="fc" id="L260">        attribute.setRawValue (&quot;no&quot;);</span>
<span class="pc bpc" id="L261" title="1 of 2 branches missed.">        assertTrue (&quot;should not be standalone&quot;, !attribute.isStandAlone ());</span>
<span class="pc bpc" id="L262" title="1 of 2 branches missed.">        assertTrue (&quot;should not be whitespace&quot;, !attribute.isWhitespace ());</span>
<span class="fc" id="L263">        assertTrue (&quot;should be valued&quot;, attribute.isValued ());</span>
<span class="pc bpc" id="L264" title="1 of 2 branches missed.">        assertTrue (&quot;should not be empty&quot;, !attribute.isEmpty ());</span>
<span class="fc" id="L265">         attributes.add (attribute);</span>
<span class="fc" id="L266">        attributes.add (space);</span>
<span class="fc" id="L267">        attribute = new PageAttribute ();</span>
<span class="fc" id="L268">        attribute.setName (&quot;name&quot;);</span>
<span class="fc" id="L269">        attribute.setAssignment (&quot;=&quot;);</span>
<span class="fc" id="L270">        attribute.setValue (&quot;topFrame&quot;);</span>
<span class="fc" id="L271">        attribute.setQuote ('&quot;');</span>
<span class="pc bpc" id="L272" title="1 of 2 branches missed.">        assertTrue (&quot;should not be standalone&quot;, !attribute.isStandAlone ());</span>
<span class="pc bpc" id="L273" title="1 of 2 branches missed.">        assertTrue (&quot;should not be whitespace&quot;, !attribute.isWhitespace ());</span>
<span class="fc" id="L274">        assertTrue (&quot;should be valued&quot;, attribute.isValued ());</span>
<span class="pc bpc" id="L275" title="1 of 2 branches missed.">        assertTrue (&quot;should not be empty&quot;, !attribute.isEmpty ());</span>
<span class="fc" id="L276">         attributes.add (attribute);</span>
<span class="fc" id="L277">        tag = new TagNode (null, 0, 0, attributes);</span>
<span class="fc" id="L278">        html = &quot;&lt;wombat label=\&quot;The civil war.\&quot; frameborder= no name=\&quot;topFrame\&quot;&gt;&quot;;</span>
<span class="fc" id="L279">        assertStringEquals (&quot;tag contents&quot;, html, tag.toHtml ());</span>
<span class="fc" id="L280">    }</span>

    /**
     * Test simple value.
     */
    public void testParseParameters() {
<span class="fc" id="L286">        getParameterTableFor(&quot;a b = \&quot;c\&quot;&quot;);</span>
<span class="fc" id="L287">        assertEquals(&quot;Value&quot;,&quot;c&quot;,((Attribute)(attributes.elementAt (2))).getValue ());</span>
<span class="fc" id="L288">    }</span>

    /**
     * Test quote value.
     */
    public void testParseTokenValues() {
<span class="fc" id="L294">        getParameterTableFor(&quot;a b = \&quot;'\&quot;&quot;);</span>
<span class="fc" id="L295">        assertEquals(&quot;Value&quot;,&quot;'&quot;,((Attribute)(attributes.elementAt (2))).getValue ());</span>
<span class="fc" id="L296">    }</span>

    /**
     * Test empty value.
     */
    public void testParseEmptyValues() {
<span class="fc" id="L302">        getParameterTableFor(&quot;a b = \&quot;\&quot;&quot;);</span>
<span class="fc" id="L303">        assertEquals(&quot;Value&quot;,&quot;&quot;,((Attribute)(attributes.elementAt (2))).getValue ());</span>
<span class="fc" id="L304">    }</span>

    /**
     * Test no equals or whitespace.
     * This might be reason for another rule, since another interpretation
     * would have an attribute called B with a value of &quot;C&quot;.
     */
    public void testParseMissingEqual() {
<span class="fc" id="L312">        getParameterTableFor(&quot;a b\&quot;c\&quot;&quot;);</span>
<span class="fc" id="L313">        assertEquals(&quot;NameC&quot;, &quot;b\&quot;c\&quot;&quot;, ((Attribute)(attributes.elementAt (2))).getName ());</span>
<span class="fc" id="L314">    }</span>

    /**
     * Test multiple attributes.
     */
    public void testTwoParams(){
<span class="fc" id="L320">        getParameterTableFor(&quot;PARAM NAME=\&quot;Param1\&quot; VALUE=\&quot;Somik\&quot;&quot;);</span>
<span class="fc" id="L321">        assertEquals(&quot;Param1&quot;,&quot;Param1&quot;,((Attribute)(attributes.elementAt (2))).getValue ());</span>
<span class="fc" id="L322">        assertEquals(&quot;Somik&quot;,&quot;Somik&quot;,((Attribute)(attributes.elementAt (4))).getValue ());</span>
<span class="fc" id="L323">    }</span>

    /**
     * Test unquoted attributes.
     */
    public void testPlainParams(){
<span class="fc" id="L329">        getParameterTableFor(&quot;PARAM NAME=Param1 VALUE=Somik&quot;);</span>
<span class="fc" id="L330">        assertEquals(&quot;Param1&quot;,&quot;Param1&quot;,((Attribute)(attributes.elementAt (2))).getValue ());</span>
<span class="fc" id="L331">        assertEquals(&quot;Somik&quot;,&quot;Somik&quot;,((Attribute)(attributes.elementAt (4))).getValue ());</span>
<span class="fc" id="L332">    }</span>

    /**
     * Test standalone attribute.
     */
    public void testValueMissing() {
<span class="fc" id="L338">        getParameterTableFor(&quot;INPUT type=\&quot;checkbox\&quot; name=\&quot;Authorize\&quot; value=\&quot;Y\&quot; checked&quot;);</span>
<span class="fc" id="L339">        assertEquals(&quot;Name of Tag&quot;,&quot;INPUT&quot;,((Attribute)(attributes.elementAt (0))).getName ());</span>
<span class="fc" id="L340">        assertEquals(&quot;Type&quot;,&quot;checkbox&quot;,((Attribute)(attributes.elementAt (2))).getValue ());</span>
<span class="fc" id="L341">        assertEquals(&quot;Name&quot;,&quot;Authorize&quot;,((Attribute)(attributes.elementAt (4))).getValue ());</span>
<span class="fc" id="L342">        assertEquals(&quot;Value&quot;,&quot;Y&quot;,((Attribute)(attributes.elementAt (6))).getValue ());</span>
<span class="fc" id="L343">        assertEquals(&quot;Checked&quot;,null,((Attribute)(attributes.elementAt (8))).getValue ());</span>
<span class="fc" id="L344">    }</span>

    /**
     * This is a simulation of a bug reported by Dhaval Udani - wherein
     * a space before the end of the tag causes a problem - there is a key
     * in the table with just a space in it and an empty value
     */
    public void testIncorrectSpaceKeyBug() {
<span class="fc" id="L352">        getParameterTableFor(&quot;TEXTAREA name=\&quot;Remarks\&quot; &quot;);</span>
        // There should only be two keys..
<span class="fc" id="L354">        assertEquals(&quot;There should only be two attributes&quot;,4,attributes.size());</span>
        // The first key is name
<span class="fc" id="L356">        assertEquals(&quot;Expected name&quot;,&quot;TEXTAREA&quot;,((Attribute)(attributes.elementAt (0))).getName ());</span>
<span class="fc" id="L357">        assertEquals(&quot;Expected value 1&quot;, &quot;Remarks&quot;,((Attribute)(attributes.elementAt (2))).getValue ());</span>
<span class="fc" id="L358">    }</span>

    /**
     * Test empty attribute.
     */
    public void testNullTag(){
<span class="fc" id="L364">        getParameterTableFor(&quot;INPUT type=&quot;);</span>
<span class="fc" id="L365">        assertEquals(&quot;Name of Tag&quot;,&quot;INPUT&quot;,((Attribute)(attributes.elementAt (0))).getName ());</span>
<span class="fc" id="L366">        assertNull(&quot;Type&quot;,((Attribute)(attributes.elementAt (2))).getValue ());</span>
<span class="fc" id="L367">    }</span>

    /**
     * Test attribute containing an equals sign.
     */
    public void testAttributeWithSpuriousEqualTo() {
<span class="fc" id="L373">        getParameterTableFor(</span>
<span class="fc" id="L374">            &quot;a class=rlbA href=/news/866201.asp?0sl=-32&quot;</span>
        );
<span class="fc" id="L376">        assertStringEquals(</span>
<span class="fc" id="L377">            &quot;href&quot;,</span>
<span class="fc" id="L378">            &quot;/news/866201.asp?0sl=-32&quot;,</span>
<span class="fc" id="L379">            ((Attribute)(attributes.elementAt (4))).getValue ()</span>
        );
<span class="fc" id="L381">    }</span>

    /**
     * Test attribute containing a question mark.
     */
    public void testQuestionMarksInAttributes() {
<span class="fc" id="L387">        getParameterTableFor(</span>
<span class="fc" id="L388">            &quot;a href=\&quot;mailto:sam@neurogrid.com?subject=Site Comments\&quot;&quot;</span>
        );
<span class="fc" id="L390">        assertStringEquals(</span>
<span class="fc" id="L391">            &quot;href&quot;,</span>
<span class="fc" id="L392">            &quot;mailto:sam@neurogrid.com?subject=Site Comments&quot;,</span>
<span class="fc" id="L393">            ((Attribute)(attributes.elementAt (2))).getValue ()</span>
        );
<span class="fc" id="L395">        assertStringEquals(</span>
<span class="fc" id="L396">            &quot;tag name&quot;,</span>
<span class="fc" id="L397">            &quot;a&quot;,</span>
<span class="fc" id="L398">            ((Attribute)(attributes.elementAt (0))).getName ()</span>
        );
<span class="fc" id="L400">    }</span>

    /**
     * Check that an empty tag is considered a string node.
     * Believe it or not Moi (vincent_aumont) wants htmlparser to parse a text file
     * containing something that looks nearly like a tag:
     * &lt;pre&gt;
     * &quot;basic_string&amp;lt;char, string_char_traits&amp;lt;char&amp;gt;, &amp;lt;&amp;gt;&amp;gt;::basic_string()&quot;
     * &lt;/pre&gt;
     * This was throwing a null pointer exception when the empty &amp;lt;&amp;gt; was encountered.
     * Bug #725420 NPE in StringBean.visitTag
     **/
    public void testEmptyTag () {
<span class="fc" id="L413">        getParameterTableFor(&quot;&quot;);</span>
<span class="fc" id="L414">        assertNull (&quot;&lt;&gt; is not a tag&quot;,attributes);</span>
<span class="fc" id="L415">    }</span>

    /**
     * Test attributes when they contain scriptlets.
     * Submitted by Cory Seefurth
     * See also feature request #725376 Handle script in attributes.
     */
    public void testJspWithinAttributes() {
        if (JSP_TESTS_ENABLED)
        {
            getParameterTableFor(
                &quot;a href=\&quot;&lt;%=Application(\&quot;sURL\&quot;)%&gt;/literature/index.htm&quot;
            );
            assertStringEquals(
                &quot;href&quot;,
                &quot;&lt;%=Application(\&quot;sURL\&quot;)%&gt;/literature/index.htm&quot;,
                ((Attribute)(attributes.elementAt (2))).getValue ()
            );
        }
<span class="fc" id="L434">    }</span>

    /**
     * Test Script in attributes.
     * See feature request #725376 Handle script in attributes.
     */
    public void testScriptedTag () {
<span class="fc" id="L441">        getParameterTableFor(&quot;body onLoad=defaultStatus=''&quot;);</span>
<span class="fc" id="L442">        String name = ((Attribute)(attributes.elementAt (0))).getName ();</span>
<span class="fc" id="L443">        assertNotNull (&quot;No Tag.TAGNAME&quot;, name);</span>
<span class="fc" id="L444">        assertStringEquals(&quot;tag name parsed incorrectly&quot;, &quot;body&quot;, name);</span>
<span class="fc" id="L445">        String value = ((Attribute)(attributes.elementAt (2))).getValue ();</span>
<span class="fc" id="L446">        assertStringEquals (&quot;parameter parsed incorrectly&quot;, &quot;defaultStatus=''&quot;, value);</span>
<span class="fc" id="L447">    }</span>

    /**
     * Test that stand-alone attributes are kept that way, rather than being
     * given empty values.
     * -Joe Robins, 6/19/03
     */
    public void testStandaloneAttribute ()
    {
<span class="fc" id="L456">        getParameterTableFor (&quot;INPUT DISABLED&quot;);</span>
<span class="fc" id="L457">        assertStringEquals(&quot;Standalone attribute not parsed&quot;,&quot;DISABLED&quot;,((Attribute)(attributes.elementAt (2))).getName ());</span>
<span class="fc" id="L458">        assertNull (&quot;Standalone attribute has non-null value&quot;,((Attribute)(attributes.elementAt (2))).getValue ());</span>
<span class="fc" id="L459">    }</span>

    /**
     * Test missing value.
     */
    public void testMissingAttribute ()
    {
<span class="fc" id="L466">        getParameterTableFor (&quot;INPUT DISABLED=&quot;);</span>
<span class="fc" id="L467">        assertStringEquals(&quot;Empty attribute has no attribute&quot;,&quot;DISABLED&quot;,((Attribute)(attributes.elementAt (2))).getName ());</span>
<span class="fc" id="L468">        assertEquals (&quot;Attribute has non-blank value&quot;,null,((Attribute)(attributes.elementAt (2))).getValue ());</span>
<span class="fc" id="L469">    }</span>

    /**
     * Test Rule 1.
     * See discussion in Bug#891058 Bug in lexer. regarding alternate interpretations.
     */
    public void testRule1 ()
    {
<span class="fc" id="L477">        getParameterTableFor (&quot;tag att = other=fred&quot;);</span>
<span class="fc" id="L478">        assertStringEquals(&quot;Attribute not parsed&quot;,&quot;att&quot;,((Attribute)(attributes.elementAt (2))).getName ());</span>
<span class="fc" id="L479">        assertEquals (&quot;Attribute has wrong value&quot;, &quot;other=fred&quot;, ((Attribute)(attributes.elementAt (2))).getValue ());</span>
<span class="fc bfc" id="L480" title="All 2 branches covered.">        for (int i = 0; i &lt; attributes.size (); i++)</span>
<span class="pc bpc" id="L481" title="1 of 2 branches missed.">            assertTrue (&quot;No attribute should be called =&quot;, !((Attribute)(attributes.elementAt (2))).getName ().equals (&quot;=&quot;));</span>
<span class="fc" id="L482">    }</span>

    /**
     * Test Rule 2.
     */
    public void testRule2 ()
    {
<span class="fc" id="L489">        getParameterTableFor (&quot;tag att =value other=fred&quot;);</span>
<span class="fc" id="L490">        assertStringEquals(&quot;Attribute not parsed&quot;,&quot;att&quot;,((Attribute)(attributes.elementAt (2))).getName ());</span>
<span class="fc" id="L491">        assertEquals (&quot;Attribute has wrong value&quot;, &quot;value&quot;, ((Attribute)(attributes.elementAt (2))).getValue ());</span>
<span class="fc bfc" id="L492" title="All 2 branches covered.">        for (int i = 0; i &lt; attributes.size (); i++)</span>
<span class="pc bpc" id="L493" title="1 of 2 branches missed.">            assertTrue (&quot;No attribute should be called =value&quot;, !((Attribute)(attributes.elementAt (2))).getName ().equals (&quot;=value&quot;));</span>
<span class="fc" id="L494">        assertStringEquals(&quot;Empty attribute not parsed&quot;,&quot;other&quot;,((Attribute)(attributes.elementAt (4))).getName ());</span>
<span class="fc" id="L495">        assertEquals (&quot;Attribute has wrong value&quot;, &quot;fred&quot;, ((Attribute)(attributes.elementAt (4))).getValue ());</span>
<span class="fc" id="L496">    }</span>

    /**
     * Test Rule 3.
     */
    public void testRule3 ()
    {
<span class="fc" id="L503">        getParameterTableFor (&quot;tag att= \&quot;value\&quot; other=fred&quot;);</span>
<span class="fc" id="L504">        assertStringEquals(&quot;Attribute not parsed&quot;,&quot;att&quot;,((Attribute)(attributes.elementAt (2))).getName ());</span>
<span class="fc" id="L505">        assertEquals (&quot;Attribute has wrong value&quot;, &quot;value&quot;, ((Attribute)(attributes.elementAt (2))).getValue ());</span>
<span class="fc bfc" id="L506" title="All 2 branches covered.">        for (int i = 0; i &lt; attributes.size (); i++)</span>
<span class="pc bpc" id="L507" title="1 of 2 branches missed.">            assertTrue (&quot;No attribute should be called \&quot;value\&quot;&quot;, !((Attribute)(attributes.elementAt (2))).getName ().equals (&quot;\&quot;value\&quot;&quot;));</span>
<span class="fc" id="L508">        assertStringEquals(&quot;Empty attribute not parsed&quot;,&quot;other&quot;,((Attribute)(attributes.elementAt (4))).getName ());</span>
<span class="fc" id="L509">        assertEquals (&quot;Attribute has wrong value&quot;, &quot;fred&quot;, ((Attribute)(attributes.elementAt (4))).getValue ());</span>
<span class="fc" id="L510">    }</span>

    /**
     * Test Rule 4.
     * See discussion in Bug#891058 Bug in lexer. regarding alternate interpretations.
     */
    public void testRule4 ()
    {
<span class="fc" id="L518">        getParameterTableFor (&quot;tag att=\&quot;va\&quot;lue\&quot; other=fred&quot;);</span>
<span class="fc" id="L519">        assertStringEquals(&quot;Attribute not parsed&quot;,&quot;att&quot;,((Attribute)(attributes.elementAt (2))).getName ());</span>
<span class="fc" id="L520">        assertEquals (&quot;Attribute has wrong value&quot;, &quot;va&quot;, ((Attribute)(attributes.elementAt (2))).getValue ());</span>
<span class="fc bfc" id="L521" title="All 2 branches covered.">        for (int i = 0; i &lt; attributes.size (); i++)</span>
<span class="pc bpc" id="L522" title="1 of 2 branches missed.">            assertTrue (&quot;No attribute should be called va\&quot;lue&quot;, !((Attribute)(attributes.elementAt (2))).getName ().equals (&quot;va\&quot;lue&quot;));</span>
<span class="fc" id="L523">        assertStringEquals(&quot;Attribute missing&quot;,&quot;att&quot;,((Attribute)(attributes.elementAt (2))).getName ());</span>
<span class="fc" id="L524">        assertStringEquals(&quot;Attribute not parsed&quot;,&quot;lue\&quot;&quot;,((Attribute)(attributes.elementAt (3))).getName ());</span>
<span class="fc" id="L525">        assertNull (&quot;Attribute has wrong value&quot;, ((Attribute)(attributes.elementAt (3))).getValue ());</span>
<span class="fc" id="L526">        assertStringEquals(&quot;Empty attribute not parsed&quot;,&quot;other&quot;,((Attribute)(attributes.elementAt (5))).getName ());</span>
<span class="fc" id="L527">        assertEquals (&quot;Attribute has wrong value&quot;, &quot;fred&quot;, ((Attribute)(attributes.elementAt (5))).getValue ());</span>
<span class="fc" id="L528">    }</span>

    /**
     * Test Rule 5.
     * See discussion in Bug#891058 Bug in lexer. regarding alternate interpretations.
     */
    public void testRule5 ()
    {
<span class="fc" id="L536">        getParameterTableFor (&quot;tag att='va'lue' other=fred&quot;);</span>
<span class="fc" id="L537">        assertStringEquals(&quot;Attribute not parsed&quot;,&quot;att&quot;,((Attribute)(attributes.elementAt (2))).getName ());</span>
<span class="fc" id="L538">        assertEquals (&quot;Attribute has wrong value&quot;, &quot;va&quot;, ((Attribute)(attributes.elementAt (2))).getValue ());</span>
<span class="fc bfc" id="L539" title="All 2 branches covered.">        for (int i = 0; i &lt; attributes.size (); i++)</span>
<span class="pc bpc" id="L540" title="1 of 2 branches missed.">            assertTrue (&quot;No attribute should be called va'lue&quot;, !((Attribute)(attributes.elementAt (2))).getName ().equals (&quot;va'lue&quot;));</span>
<span class="fc" id="L541">        assertStringEquals(&quot;Attribute not parsed&quot;,&quot;lue'&quot;,((Attribute)(attributes.elementAt (3))).getName ());</span>
<span class="fc" id="L542">        assertNull (&quot;Attribute has wrong value&quot;, ((Attribute)(attributes.elementAt (3))).getValue ());</span>
<span class="fc" id="L543">        assertStringEquals(&quot;Empty attribute not parsed&quot;,&quot;other&quot;,((Attribute)(attributes.elementAt (5))).getName ());</span>
<span class="fc" id="L544">        assertEquals (&quot;Attribute has wrong value&quot;, &quot;fred&quot;, ((Attribute)(attributes.elementAt (5))).getValue ());</span>
<span class="fc" id="L545">    }</span>
    
    /**
     * Test for lost attributes.
     * see bug #778781 SRC-attribute suppression in IMG-tags
     * &amp; #753012 IMG SRC not parsed v1.3 &amp; v1.4
     * &amp; #755929 Empty string attr. value causes attr parsing to be stopped
     * &amp; #778781 SRC-attribute suppression in IMG-tags
     * &amp; #832530 empty attribute causes parser to fail
     * &amp; #851882 zero length alt tag causes bug in ImageScanner
     *
     *    HTML before parse:
     *    &lt;img src=&quot;images/first&quot; alt=&quot;first&quot;&gt;&quot;
     *    &lt;img src=&quot;images/second&quot; alt=&quot;&quot;&gt;
     *    &lt;img alt=&quot;third&quot; src=&quot;images/third&quot;&gt;
     *    &lt;img alt=&quot;&quot; src=&quot;images/fourth&quot;&gt;
     *
     *    HTML after parse:
     *    &lt;IMG ALT=&quot;first&quot; SRC=&quot;images/first&quot;&gt;
     *    &lt;IMG ALT=&quot;&quot; SRC=&quot;images/second&quot;&gt;
     *    &lt;IMG ALT=&quot;third&quot; SRC=&quot;images/third&quot;&gt;
     *    &lt;IMG ALT=&quot;&quot;&gt;
     */
    public void testSrcAndAlt () throws ParserException
    {
<span class="fc" id="L570">        String html = &quot;&lt;img src=\&quot;images/first\&quot; alt=\&quot;first\&quot;&gt;&quot;;</span>

<span class="fc" id="L572">        createParser (html);</span>
<span class="fc" id="L573">        parseAndAssertNodeCount (1);</span>
<span class="fc" id="L574">        assertTrue (&quot;Node should be an ImageTag&quot;, node[0] instanceof ImageTag);</span>
<span class="fc" id="L575">        ImageTag img = (ImageTag)node[0];</span>
<span class="fc" id="L576">        assertTrue (&quot;bad source&quot;, &quot;images/first&quot;.equals (img.getImageURL ()));</span>
<span class="fc" id="L577">        assertTrue (&quot;bad alt&quot;, &quot;first&quot;.equals (img.getAttribute (&quot;alt&quot;)));</span>
<span class="fc" id="L578">        assertStringEquals (&quot;toHtml()&quot;, html, img.toHtml ());</span>
<span class="fc" id="L579">    }</span>

    /**
     * see bug #778781 SRC-attribute suppression in IMG-tags
     */
    public void testSrcAndEmptyAlt () throws ParserException
    {
<span class="fc" id="L586">        String html = &quot;&lt;img src=\&quot;images/second\&quot; alt=\&quot;\&quot;&gt;&quot;;</span>

<span class="fc" id="L588">        createParser (html);</span>
<span class="fc" id="L589">        parseAndAssertNodeCount (1);</span>
<span class="fc" id="L590">        assertTrue (&quot;Node should be an ImageTag&quot;, node[0] instanceof ImageTag);</span>
<span class="fc" id="L591">        ImageTag img = (ImageTag)node[0];</span>
<span class="fc" id="L592">        assertTrue (&quot;bad source&quot;, &quot;images/second&quot;.equals (img.getImageURL ()));</span>
<span class="fc" id="L593">        assertTrue (&quot;bad alt&quot;, &quot;&quot;.equals (img.getAttribute (&quot;alt&quot;)));</span>
<span class="fc" id="L594">        assertStringEquals (&quot;toHtml()&quot;, html, img.toHtml ());</span>
<span class="fc" id="L595">    }</span>

    /**
     * see bug #778781 SRC-attribute suppression in IMG-tags
     */
    public void testAltAndSrc () throws ParserException
    {
<span class="fc" id="L602">        String html = &quot;&lt;img alt=\&quot;third\&quot; src=\&quot;images/third\&quot;&gt;&quot;;</span>

<span class="fc" id="L604">        createParser (html);</span>
<span class="fc" id="L605">        parseAndAssertNodeCount (1);</span>
<span class="fc" id="L606">        assertTrue (&quot;Node should be an ImageTag&quot;, node[0] instanceof ImageTag);</span>
<span class="fc" id="L607">        ImageTag img = (ImageTag)node[0];</span>
<span class="fc" id="L608">        assertTrue (&quot;bad source&quot;, &quot;images/third&quot;.equals (img.getImageURL ()));</span>
<span class="fc" id="L609">        assertTrue (&quot;bad alt&quot;, &quot;third&quot;.equals (img.getAttribute (&quot;alt&quot;)));</span>
<span class="fc" id="L610">        assertStringEquals (&quot;toHtml()&quot;, html, img.toHtml ());</span>
<span class="fc" id="L611">    }</span>

    /**
     * see bug #778781 SRC-attribute suppression in IMG-tags
     */
    public void testEmptyAltAndSrc () throws ParserException
    {
<span class="fc" id="L618">        String html = &quot;&lt;img alt=\&quot;\&quot; src=\&quot;images/third\&quot;&gt;&quot;;</span>

<span class="fc" id="L620">        createParser (html);</span>
<span class="fc" id="L621">        parseAndAssertNodeCount (1);</span>
<span class="fc" id="L622">        assertTrue (&quot;Node should be an ImageTag&quot;, node[0] instanceof ImageTag);</span>
<span class="fc" id="L623">        ImageTag img = (ImageTag)node[0];</span>
<span class="fc" id="L624">        assertTrue (&quot;bad source&quot;, &quot;images/third&quot;.equals (img.getImageURL ()));</span>
<span class="fc" id="L625">        assertTrue (&quot;bad alt&quot;, &quot;&quot;.equals (img.getAttribute (&quot;alt&quot;)));</span>
<span class="fc" id="L626">        assertStringEquals (&quot;toHtml()&quot;, html, img.toHtml ());</span>
<span class="fc" id="L627">    }</span>

    /**
     * see bug #911565 isValued() and isNull() don't work
     */
    public void testPredicates () throws ParserException
    {
<span class="fc" id="L634">        String html1 = &quot;&lt;img alt=\&quot;\&quot; src=\&quot;images/third\&quot; readonly&gt;&quot;;</span>
<span class="fc" id="L635">        String html2 = &quot;&lt;img src=\&quot;images/third\&quot; readonly alt=\&quot;\&quot;&gt;&quot;;</span>
<span class="fc" id="L636">        String html3 = &quot;&lt;img readonly alt=\&quot;\&quot; src=\&quot;images/third\&quot;&gt;&quot;;</span>
<span class="fc" id="L637">        String htmls[] = { html1, html2, html3 };</span>

<span class="fc bfc" id="L639" title="All 2 branches covered.">        for (int i = 0; i &lt; htmls.length; i++)</span>
        {
<span class="fc" id="L641">            createParser (htmls[i]);</span>
<span class="fc" id="L642">            parseAndAssertNodeCount (1);</span>
<span class="fc" id="L643">            assertTrue (&quot;Node should be an ImageTag&quot;, node[0] instanceof ImageTag);</span>
<span class="fc" id="L644">            ImageTag img = (ImageTag)node[0];</span>
<span class="fc" id="L645">            Attribute src = img.getAttributeEx (&quot;src&quot;);</span>
<span class="fc" id="L646">            Attribute alt = img.getAttributeEx (&quot;alt&quot;);</span>
<span class="fc" id="L647">            Attribute readonly = img.getAttributeEx (&quot;readonly&quot;);</span>
<span class="pc bpc" id="L648" title="1 of 2 branches missed.">            assertTrue (&quot;src whitespace&quot;, !src.isWhitespace ());</span>
<span class="fc" id="L649">            assertTrue (&quot;src not valued&quot;, src.isValued ());</span>
<span class="pc bpc" id="L650" title="1 of 2 branches missed.">            assertTrue (&quot;src empty&quot;, !src.isEmpty ());</span>
<span class="pc bpc" id="L651" title="1 of 2 branches missed.">            assertTrue (&quot;src standalone&quot;, !src.isStandAlone ());</span>
<span class="pc bpc" id="L652" title="1 of 2 branches missed.">            assertTrue (&quot;alt whitespace&quot;, !alt.isWhitespace ());</span>
<span class="pc bpc" id="L653" title="1 of 2 branches missed.">            assertTrue (&quot;alt valued&quot;, !alt.isValued ());</span>
<span class="pc bpc" id="L654" title="1 of 2 branches missed.">            assertTrue (&quot;alt empty&quot;, !alt.isEmpty ());</span>
<span class="pc bpc" id="L655" title="1 of 2 branches missed.">            assertTrue (&quot;alt standalone&quot;, !alt.isStandAlone ());</span>
<span class="pc bpc" id="L656" title="1 of 2 branches missed.">            assertTrue (&quot;readonly whitespace&quot;, !readonly.isWhitespace ());</span>
<span class="pc bpc" id="L657" title="1 of 2 branches missed.">            assertTrue (&quot;readonly valued&quot;, !readonly.isValued ());</span>
<span class="pc bpc" id="L658" title="1 of 2 branches missed.">            assertTrue (&quot;readonly empty&quot;, !readonly.isEmpty ());</span>
<span class="fc" id="L659">            assertTrue (&quot;readonly not standalone&quot;, readonly.isStandAlone ());</span>
            // try assigning the name and checking again
<span class="fc" id="L661">            src.setName (&quot;SRC&quot;);</span>
<span class="fc" id="L662">            assertTrue (&quot;setName() failed&quot;, &quot;SRC=\&quot;images/third\&quot;&quot;.equals (src.toString ()));</span>
<span class="pc bpc" id="L663" title="1 of 2 branches missed.">            assertTrue (&quot;src whitespace&quot;, !src.isWhitespace ());</span>
<span class="fc" id="L664">            assertTrue (&quot;src not valued&quot;, src.isValued ());</span>
<span class="pc bpc" id="L665" title="1 of 2 branches missed.">            assertTrue (&quot;src empty&quot;, !src.isEmpty ());</span>
<span class="pc bpc" id="L666" title="1 of 2 branches missed.">            assertTrue (&quot;src standalone&quot;, !src.isStandAlone ());</span>
<span class="fc" id="L667">            alt.setName (&quot;ALT&quot;);</span>
<span class="fc" id="L668">            assertTrue (&quot;setName() failed&quot;, &quot;ALT=\&quot;\&quot;&quot;.equals (alt.toString ()));</span>
<span class="pc bpc" id="L669" title="1 of 2 branches missed.">            assertTrue (&quot;alt whitespace&quot;, !alt.isWhitespace ());</span>
<span class="pc bpc" id="L670" title="1 of 2 branches missed.">            assertTrue (&quot;alt valued&quot;, !alt.isValued ());</span>
<span class="pc bpc" id="L671" title="1 of 2 branches missed.">            assertTrue (&quot;alt empty&quot;, !alt.isEmpty ());</span>
<span class="pc bpc" id="L672" title="1 of 2 branches missed.">            assertTrue (&quot;alt standalone&quot;, !alt.isStandAlone ());</span>
<span class="fc" id="L673">            readonly.setName (&quot;READONLY&quot;);</span>
<span class="fc" id="L674">            assertTrue (&quot;setName() failed&quot;, &quot;READONLY&quot;.equals (readonly.toString ()));</span>
<span class="pc bpc" id="L675" title="1 of 2 branches missed.">            assertTrue (&quot;readonly whitespace&quot;, !readonly.isWhitespace ());</span>
<span class="pc bpc" id="L676" title="1 of 2 branches missed.">            assertTrue (&quot;readonly valued&quot;, !readonly.isValued ());</span>
<span class="pc bpc" id="L677" title="1 of 2 branches missed.">            assertTrue (&quot;readonly empty&quot;, !readonly.isEmpty ());</span>
<span class="fc" id="L678">            assertTrue (&quot;readonly not standalone&quot;, readonly.isStandAlone ());</span>
            // try assigning the assignment and checking again
<span class="fc" id="L680">            src.setAssignment (&quot; = &quot;);</span>
<span class="fc" id="L681">            assertTrue (&quot;setAssignment() failed&quot;, &quot;SRC = \&quot;images/third\&quot;&quot;.equals (src.toString ()));</span>
<span class="pc bpc" id="L682" title="1 of 2 branches missed.">            assertTrue (&quot;src whitespace&quot;, !src.isWhitespace ());</span>
<span class="fc" id="L683">            assertTrue (&quot;src not valued&quot;, src.isValued ());</span>
<span class="pc bpc" id="L684" title="1 of 2 branches missed.">            assertTrue (&quot;src empty&quot;, !src.isEmpty ());</span>
<span class="pc bpc" id="L685" title="1 of 2 branches missed.">            assertTrue (&quot;src standalone&quot;, !src.isStandAlone ());</span>
<span class="fc" id="L686">            alt.setAssignment (&quot; = &quot;);</span>
<span class="fc" id="L687">            assertTrue (&quot;setAssignment() failed&quot;, &quot;ALT = \&quot;\&quot;&quot;.equals (alt.toString ()));</span>
<span class="pc bpc" id="L688" title="1 of 2 branches missed.">            assertTrue (&quot;alt whitespace&quot;, !alt.isWhitespace ());</span>
<span class="pc bpc" id="L689" title="1 of 2 branches missed.">            assertTrue (&quot;alt valued&quot;, !alt.isValued ());</span>
<span class="pc bpc" id="L690" title="1 of 2 branches missed.">            assertTrue (&quot;alt empty&quot;, !alt.isEmpty ());</span>
<span class="pc bpc" id="L691" title="1 of 2 branches missed.">            assertTrue (&quot;alt standalone&quot;, !alt.isStandAlone ());</span>
<span class="fc" id="L692">            readonly.setAssignment (&quot;=&quot;);</span>
<span class="fc" id="L693">            assertTrue (&quot;setAssignment() failed&quot;, &quot;READONLY=&quot;.equals (readonly.toString ()));</span>
<span class="pc bpc" id="L694" title="1 of 2 branches missed.">            assertTrue (&quot;readonly whitespace&quot;, !readonly.isWhitespace ());</span>
<span class="pc bpc" id="L695" title="1 of 2 branches missed.">            assertTrue (&quot;readonly valued&quot;, !readonly.isValued ());</span>
<span class="fc" id="L696">            assertTrue (&quot;readonly not empty&quot;, readonly.isEmpty ());</span>
<span class="pc bpc" id="L697" title="1 of 2 branches missed.">            assertTrue (&quot;readonly standalone&quot;, !readonly.isStandAlone ());</span>
            // try assigning the value and checking again
<span class="fc" id="L699">            createParser (htmls[i]);</span>
<span class="fc" id="L700">            parseAndAssertNodeCount (1);</span>
<span class="fc" id="L701">            assertTrue (&quot;Node should be an ImageTag&quot;, node[0] instanceof ImageTag);</span>
<span class="fc" id="L702">            img = (ImageTag)node[0];</span>
<span class="fc" id="L703">            src = img.getAttributeEx (&quot;src&quot;);</span>
<span class="fc" id="L704">            alt = img.getAttributeEx (&quot;alt&quot;);</span>
<span class="fc" id="L705">            readonly = img.getAttributeEx (&quot;readonly&quot;);</span>
<span class="fc" id="L706">            src.setValue (&quot;cgi-bin/redirect&quot;);</span>
<span class="fc" id="L707">            assertTrue (&quot;setValue() failed&quot;, &quot;src=\&quot;cgi-bin/redirect\&quot;&quot;.equals (src.toString ()));</span>
<span class="pc bpc" id="L708" title="1 of 2 branches missed.">            assertTrue (&quot;src whitespace&quot;, !src.isWhitespace ());</span>
<span class="fc" id="L709">            assertTrue (&quot;src not valued&quot;, src.isValued ());</span>
<span class="pc bpc" id="L710" title="1 of 2 branches missed.">            assertTrue (&quot;src empty&quot;, !src.isEmpty ());</span>
<span class="pc bpc" id="L711" title="1 of 2 branches missed.">            assertTrue (&quot;src standalone&quot;, !src.isStandAlone ());</span>
<span class="fc" id="L712">            alt.setValue (&quot;no image&quot;);</span>
<span class="fc" id="L713">            assertTrue (&quot;setValue() failed&quot;, &quot;alt=\&quot;no image\&quot;&quot;.equals (alt.toString ()));</span>
<span class="pc bpc" id="L714" title="1 of 2 branches missed.">            assertTrue (&quot;alt whitespace&quot;, !alt.isWhitespace ());</span>
<span class="fc" id="L715">            assertTrue (&quot;alt not valued&quot;, alt.isValued ());</span>
<span class="pc bpc" id="L716" title="1 of 2 branches missed.">            assertTrue (&quot;alt empty&quot;, !alt.isEmpty ());</span>
<span class="pc bpc" id="L717" title="1 of 2 branches missed.">            assertTrue (&quot;alt standalone&quot;, !alt.isStandAlone ());</span>
<span class="fc" id="L718">            readonly.setValue (&quot;true&quot;); // this may be bogus, really need to set assignment too, see below</span>
<span class="fc" id="L719">            assertTrue (&quot;setValue() failed&quot;, &quot;readonlytrue&quot;.equals (readonly.toString ()));</span>
<span class="pc bpc" id="L720" title="1 of 2 branches missed.">            assertTrue (&quot;readonly whitespace&quot;, !readonly.isWhitespace ());</span>
<span class="fc" id="L721">            assertTrue (&quot;readonly not valued&quot;, readonly.isValued ());</span>
<span class="pc bpc" id="L722" title="1 of 2 branches missed.">            assertTrue (&quot;readonly empty&quot;, !readonly.isEmpty ());</span>
<span class="pc bpc" id="L723" title="1 of 2 branches missed.">            assertTrue (&quot;readonly standalone&quot;, !readonly.isStandAlone ());</span>
<span class="fc" id="L724">            readonly.setAssignment (&quot;=&quot;);</span>
<span class="fc" id="L725">            assertTrue (&quot;setAssignment() failed&quot;, &quot;readonly=true&quot;.equals (readonly.toString ()));</span>
<span class="pc bpc" id="L726" title="1 of 2 branches missed.">            assertTrue (&quot;readonly whitespace&quot;, !readonly.isWhitespace ());</span>
<span class="fc" id="L727">            assertTrue (&quot;readonly not valued&quot;, readonly.isValued ());</span>
<span class="pc bpc" id="L728" title="1 of 2 branches missed.">            assertTrue (&quot;readonly empty&quot;, !readonly.isEmpty ());</span>
<span class="pc bpc" id="L729" title="1 of 2 branches missed.">            assertTrue (&quot;readonly standalone&quot;, !readonly.isStandAlone ());</span>
        }
<span class="fc" id="L731">    }</span>

    /**
     * see bug #911565 isValued() and isNull() don't work
     */
    public void testSetQuote () throws ParserException
    {
<span class="fc" id="L738">        String html = &quot;&lt;img alt=\&quot;\&quot; src=\&quot;images/third\&quot; toast&gt;&quot;;</span>

<span class="fc" id="L740">        createParser (html);</span>
<span class="fc" id="L741">        parseAndAssertNodeCount (1);</span>
<span class="fc" id="L742">        assertTrue (&quot;Node should be an ImageTag&quot;, node[0] instanceof ImageTag);</span>
<span class="fc" id="L743">        ImageTag img = (ImageTag)node[0];</span>
<span class="fc" id="L744">        Attribute src = img.getAttributeEx (&quot;src&quot;);</span>
<span class="fc" id="L745">        src.setQuote ('\0');</span>
<span class="fc" id="L746">        assertTrue (&quot;setQuote('\\0') failed&quot;, &quot;src=images/third&quot;.equals (src.toString ()));</span>
<span class="fc" id="L747">        src.setQuote ('\'');</span>
<span class="fc" id="L748">        assertTrue (&quot;setQuote('\\'') failed&quot;, &quot;src='images/third'&quot;.equals (src.toString ()));</span>
<span class="fc" id="L749">    }</span>
    
    /**
     * see bug #979893 Not Parsing all Attributes
     */
    public void testNoSpace () throws ParserException
    {
<span class="fc" id="L756">        String id = &quot;A19012_00002&quot;;</span>
<span class="fc" id="L757">        String rawid = &quot;\&quot;&quot; + id + &quot;\&quot;&quot;;</span>
<span class="fc" id="L758">        String cls = &quot;BuyLink&quot;;</span>
<span class="fc" id="L759">        String rawcls = &quot;\&quot;&quot; + cls + &quot;\&quot;&quot;;</span>
<span class="fc" id="L760">        String href = &quot;http://www.someplace.com/buyme.html&quot;;</span>
<span class="fc" id="L761">        String rawhref = &quot;\&quot;&quot; + href + &quot;\&quot;&quot;;</span>
<span class="fc" id="L762">        String html = &quot;&lt;a id=&quot; + rawid + /* no space */ &quot;class=&quot; + rawcls + &quot; href=&quot; + rawhref + &quot;&gt;Pick me.&lt;/a&gt;&quot;;</span>
<span class="fc" id="L763">        createParser (html);</span>
<span class="fc" id="L764">        parseAndAssertNodeCount (1);</span>
<span class="fc" id="L765">        assertTrue (&quot;Node should be an LinkTag&quot;, node[0] instanceof LinkTag);</span>
<span class="fc" id="L766">        LinkTag link = (LinkTag)node[0];</span>
<span class="fc" id="L767">        Vector attributes = link.getAttributesEx ();</span>
<span class="fc" id="L768">        assertEquals (&quot;Incorrect number of attributes&quot;, 6, attributes.size ());</span>
<span class="fc" id="L769">        assertStringEquals (&quot;id wrong&quot;, rawid, link.getAttributeEx (&quot;id&quot;).getRawValue ());</span>
<span class="fc" id="L770">        assertStringEquals (&quot;class wrong&quot;, rawcls, link.getAttributeEx (&quot;class&quot;).getRawValue ());</span>
<span class="fc" id="L771">        assertStringEquals (&quot;href wrong&quot;, rawhref, link.getAttributeEx (&quot;href&quot;).getRawValue ());</span>
<span class="fc" id="L772">        assertStringEquals (&quot;id wrong&quot;, id, link.getAttributeEx (&quot;id&quot;).getValue ());</span>
<span class="fc" id="L773">        assertStringEquals (&quot;class wrong&quot;, cls, link.getAttributeEx (&quot;class&quot;).getValue ());</span>
<span class="fc" id="L774">        assertStringEquals (&quot;href wrong&quot;, href, link.getAttributeEx (&quot;href&quot;).getValue ());</span>
<span class="fc" id="L775">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span>AllTests (4) (Oct 27, 2015 3:17:09 PM)</div></body></html>